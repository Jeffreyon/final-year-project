{{#section 'title'}}
<title>{{description}} &bull; Keybase</title>
{{/section}}

{{#section 'room-css'}}
<link rel="stylesheet" href="/vendor/owlcarousel/owl.carousel.css">
<link rel="stylesheet" href="/vendor/owlcarousel/owl.theme.green.css">
{{/section}}

<main class="relative">
    <div class=" max-w-3xl lg:max-w-5xl mx-auto sm:px-3">
        <div class=" w-full sm:mt-4">
            <div class="w-full overflow-hidden sm:rounded-md border-gray-300 sm:border relative">
                <button id="carousel-open" class=" w-full block focus:outline-none">
                    <div class="image-overlay"></div>
                    <img crossorigin="anonymous" src="{{heroImage}}" class=" object-cover w-full roomHero">
                    <div class=" absolute flex justify-center right-0 mr-3 bottom-0 text-white mb-3">
                        <p class="inline-block"><i class="fa fa-images mr-2 text-gray-200"></i><span
                                class=" font-semibold">{{images.length}}</span> image{{greater images.length}}</p>
                    </div>
                </button>
            </div>
        </div>
    </div>
    <!-- listing details -->
    <section class=" mt-2 sm:mt-6">
        <div class=" px-3 max-w-3xl lg:max-w-5xl flex justify-between mx-auto relative">
            <div class="w-full lg:max-w-2xl">
                <div>
                    <h2 class="hidden sm:block text-2xl font-semibold leading-tight">{{description}}</h2>
                    <div class=" block sm:flex w-full text-gray-700 mt-3">
                        <div class=" flex mr-4 items-baseline">
                            <p class="uppercase font-semibold mr-4">{{roomType}}</p>
                            <p><i class="fa fa-map-marker-alt mr-2"></i>{{area}}, {{city}}</p>
                        </div>
                        <div class="flex mt-2 sm:mt-0">
                            <p class=" mr-4"><i class="fa fa-bed mr-2"></i><span
                                    class=" mr-1 font-semibold">{{beds}}</span>Bedroom{{greater beds}}</p>
                            <p class="mr-4"><i class="fa fa-bath mr-2"></i><span
                                    class=" mr-1 font-semibold">{{baths}}</span>Bathroom{{greater beds}}
                            </p>
                        </div>
                        {{#if upstairs}}
                        <p class="mt-2 sm:mt-0 font-semibold"><i class="fa fa-arrow-up mr-1"></i>Up stairs</p>
                        {{/if}}
                    </div>
                </div>
                <div class=" border-t border-gray-400 py-6 mt-4">
                    <h1 class=" text-xl">About room</h1>
                    <div class=" mt-6">
                        {{#each roomAmenities}}
                        <div class="mt-4">
                            <h2 class=" font-semibold -mb-1">{{roomSection}}</h2>
                            <ul class=" flex max-w-lg flex-wrap">
                                {{#each amenities}}
                                <li class="w-1/2 sm:w-4/12 mt-2 text-gray-700"><i
                                        class="fa fa-check mr-2 text-xs text-green-600"></i>{{this}}</li>
                                {{/each}}
                            </ul>
                        </div>
                        {{/each}}
                    </div>
                </div>
                <div class=" border-t border-gray-400 py-6 mt-4">
                    <h1 class=" text-xl">About lodge</h1>
                    <div class=" mt-6">
                        {{#if lodge.amenities}}
                        <div class="flex flex-wrap max-w-lg">
                            <h2 class=" font-semibold w-full">Amenities</h2>
                            {{#each lodge.amenities}}
                            <p class=" mt-2 w-1/2 sm:w-4/12"><i
                                    class="fa fa-check mr-2 text-xs text-green-600"></i>{{this}}</p>
                            {{/each}}
                        </div>
                        {{/if}}
                        {{#if lodge.curfew}}
                        <div class=" mt-5">
                            <h2 class=" font-semibold">Curfew</h2>
                            <p class=" text-gray-700 mt-2">Gate closes at {{lodge.curfew.closes}} everyday, opens at
                                {{lodge.curfew.opens}}</p>
                        </div>
                        {{/if}}
                    </div>
                </div>
                {{#if lodge.rules.length}}
                <div class=" border-t border-gray-400 py-6 mt-4">
                    <h1 class=" text-xl">Lodge rules</h1>
                    <div>
                        <div class="mt-4 block sm:flex flex-wrap">
                            {{#each lodge.rules}}
                            <p class=" mr-6 mt-2 text-gray-700">
                                {{#if allowed}}
                                <i class="fa fa-check mr-1 text-xs text-green-600"></i>
                                {{else}}
                                <i class="fa fa-times mr-1 text-xs text-red-600"></i>
                                <span>No</span>
                                {{/if}}
                                {{rule}} allowed
                            </p>
                            {{/each}}
                        </div>
                    </div>
                </div>
                {{/if}}
            </div>
            <div
                class="bg-white z-50 border-t lg:border border-gray-400 p-3 lg:p-5 lg:rounded-lg flex items-center justify-between w-full lg:max-w-xs lg:ml-5 lg:h-full fixed bottom-0 left-0 lg:block lg:sticky top-offset-20">
                <div>
                    <p class=" text-xl lg:text-2xl font-semibold">{{price}}<span class=" text-base text-gray-600"> /yr</span></p>
                    <div class="lg:hidden">
                        {{#if lodge.bills.length}}
                        <p class=" text-sm text-gray-600">
                            Some bills included
                            <button id="bills-open" class="ml-1 focus:outline-none"><i class="fa fa-info-circle text-lg"></i></button>
                        </p>
                        <div id="bills-mobile" class=" absolute hidden bg-white bottom-0 left-0 p-4 pb-8 w-full">
                            <div class=" flex w-full justify-between items-center">
                                <p class=" text-sm text-gray-600">Some bills included</p>
                                <button id="bills-close"
                                    class=" p-1 rounded-md text-gray-700 focus:outline-none focus:shadow-outline hover:bg-gray-200">
                                    <svg id="close" class="h-4 w-4" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                                    </svg>
                                </button>
                            </div>
                            <div class=" mt-5">
                                {{#each lodge.bills}}
                                <p class=" flex w-full justify-between"><span>{{bill}}</span><span>{{amount}}
                                        /{{payEvery}}</span></p>
                                {{/each}}
                            </div>
                        </div>
                        {{else}}
                        <p class=" text-sm text-gray-600">
                            No bills included
                        </p>
                        {{/if}}
                    </div>
                </div>
                <div class="hidden lg:block border p-3 my-6 rounded-md">
                    {{#if lodge.bills.length}}
                    <p class=" text-sm text-gray-700">Some bills included</p>
                    <div class=" mt-3 mb-1">
                        {{#each lodge.bills}}
                        <p class=" flex w-full justify-between"><span>{{bill}}</span><span>{{amount}}
                            <span class=" text-gray-700">/{{payEvery}}</span></span></p>
                        {{/each}}
                    </div>
                    {{else}}
                    <p class=" text-sm">No bills included</p>
                    {{/if}}
                </div>
                <div>
                    {{#if isAvailable}}
                    <a href="/new-booking/{{_id}}"
                        class=" text-white block focus:outline-none tracking-wider text-center focus:shadow-outline font-semibold px-10 lg:w-full transition duration-200 py-3 lg:py-4 hover:bg-green-600 rounded-md uppercase bg-green-500">
                        book</a>
                    <p class=" text-sm text-gray-600 hidden lg:block mt-2 text-center">You won't pay the landlord yet</p>
                    {{else}}
                    <button
                        class=" text-green-500 focus:outline-none tracking-wider cursor-not-allowed font-semibold px-6 sm:px-10 lg:w-full py-3 lg:py-4 rounded-md uppercase bg-green-100 border border-green-200">
                        <i class="fa fa-lock mr-1"></i>booked</button>
                    <p class=" text-sm text-gray-600 hidden lg:block mt-2 text-center">This room has already been booked</p>
                    {{/if}}
                </div>
            </div>
        </div>
    </section>
</main>

<div id="carousel" class="w-full fixed bottom-0 z-50 bg-gray-100 pb-24 hidden">
    <div class="pb-4">
        <div class=" sticky top-0 z-50 bg-gray-100">
            <div
                class="max-w-screen-lg mx-auto flex justify-between items-center w-full p-3 md:mt-10">
                <p class="inline-block"><i class="fa fa-images mr-2"></i><span class=" font-semibold">{{images.length}}</span>
                    images</p>
                <button id="carousel-close"
                    class=" p-2 rounded-md text-gray-700 focus:outline-none focus:shadow-outline hover:bg-gray-200">
                    <svg id="close" class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
        </div>
        <div class="max-w-screen-lg mx-auto relative mt-4 sm:mt-6 px-3">
            <div class="owl-carousel owl-theme">
                {{#each images}}
                    <div class="item max-w-xl mx-auto">
                        <div class="relative">
                            <div class="hidden md:block absolute top-0 left-0 m-3 py-1 px-3 rounded-full shadow-sm bg-white text-xs"><span class="font-bold">{{#inc @index}}{{index}}{{/inc}}</span>/{{../images.length}}</div>
                            <img crossorigin="anonymous" src="{{this}}" class="rounded" alt="room image">
                        </div>
                    </div>
                {{/each}}
            </div>
            <div class="nav hidden absolute z-50 px-12 text-green-600 left-0 right-0 md:flex justify-between">
                <button id="prev"
                    class="inline-flex h-10 w-10 font-semibold bg-white border border-gray-200 shadow-md rounded-full items-center justify-center focus:outline-none">
                    <i class="fa fa-chevron-left"></i>
                </button>
                <button id="next"
                    class="inline-flex h-10 w-10 font-semibold bg-white border border-gray-200 shadow-md rounded-full items-center justify-center focus:outline-none">
                    <i class="fa fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>
</div>

{{#section 'room-js'}}
<script src="/vendor/owlcarousel/owl.carousel.js"></script>
<script src="/js/owlcarousel_config.js"></script>
{{/section}}
